@model BookListViewModel
@using X.PagedList.Mvc.Core;
@using X.PagedList.Mvc.Common;
@using X.PagedList;

@if (Model != null)
{
    <div class="row">
        @if (Model.Books.Count() == 0)
        {
            <p> Извините, ничего не найдено! </p>
        }
        @foreach (BookView s in Model.Books)
        {
            <div class="col-md-3 col-sm bg-white border-bottom shadow-sm div-container-book">
                <a href="~/Admin/Book/@s.Id">
                    <img class="center-block img-top-bottom-space" src="~/img/@s.image" width="150" height="215" alt="@s.Title">
                </a>
                <div class="text-center">
                    <a href="~/Admin/Book/@s.Id" class="h3">
                        @s.Title
                    </a>
                </div>
                <h6>
                    @foreach (string c in s.Authors)
                    {
                        <a href="#" class="authors text-muted">
                            @c;
                        </a>
                    }
                </h6>
                <h6>
                    @foreach (string c in s.Genres)
                    {
                        <a href="#" class="authors text-muted">
                            @c;
                        </a>
                    }
                </h6>
                <h5>
                    Цена:  @s.Cost
                </h5>
                <div class="button-gr-book">
                    @if (Model.UserName == "admin")
                    {
                        <button onclick="editBook(@s.Id);" class="btn btn-dark"> Редактировать </button>
                        string passtitle = "\"" + s.Title + "\"";
                        <button onclick="areYouSure(@s.Id, @passtitle);" class="btn btn-dark"> Удалить </button>
                        <a></a>
                    }
                    else if (Model.UserName != "Войти" && Model.CurrentOrder != null)
                    {
                        if (s.Stored > 0)
                        {
                            if (!Model.CurrentOrder.BookOrders.Where(i => i.IdBook == s.Id).Any())
                            {
                                <button id=@s.Id onclick="add(@s.Id,@s.Cost,@Model.CurrentOrder.Id);" class="btn btn-dark"> Купить </button> <br />
                            }
                            else
                            {
                                <button class="btn btn-light" onclick="GetBasket();">Перейти к корзине</button>
                            }
                        }
                        else
                        { <p class="text-muted">
                                Нет на складе
                            </p>
                        }
                    }
                </div>
            </div>
        }

    </div>
    <div class="row">
        @Html.PagedListPager((IPagedList)Model.Books, page => Url.Action("Index", "Home", new { page = page, searchString = ViewBag.searchString, sortOrder = ViewBag.sortOrder, Stored = ViewBag.Stored, Genre = ViewBag.Genre }))
    </div>
}
